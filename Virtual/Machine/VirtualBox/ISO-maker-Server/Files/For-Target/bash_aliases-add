# If not already running, launch the vncserver whenever an interactive shell starts
pgrep x0vncserver > /dev/null
[[ $? -eq 1 ]] && (x0vncserver -display :0 -PasswordFile=/home/$myuser/.vnc/passwd >> /dev/null 2>&1 &)

# Modify prompt to keep track of git branches

parse_git_branch() {
    git branch 2> /dev/null | sed -e '/^[^*]/d' -e 's/* \(.*\)/ (\1)/'
}

export PS1="\u@\h:\W\$(parse_git_branch)\[\033[00m\] $ "

# Stuff to be executed only the first time a user logs into an interactive shell
if [[ ! -e /var/log/firstboot.log ]]; then # firstboot file does not exist because on the first boot no time has elapsed in which to set it
    # Tell them what's going on in the other window
    xfce4-terminal --geometry 80x12+0+0 --command "echo ; echo The machine is installing more software ; echo It will reboot one more time before it finishes. ; echo Please wait until that reboot before using it."
    # Monitor installations on the "finish" script
    xfce4-terminal --geometry 132x24+0-0 --command "bash -c 'tail -F /var/local/start-and-finish.log'"  # Watch the remaining installations; user should be smart enough to understand what they should and should not do while system is being installed/upgraded
fi



